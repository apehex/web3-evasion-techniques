\section{Hidden State} \label{sec:hidden-state}

\subsection{Overview}

The used storage slots are not explicitely listed: data can be slipped in the huge address space of the storage without leaving a public handle.

\begin{description}
\item[initialization]{the constructor code is not in the available bytecode, it can fill slots without raising any flag}
\item[delegation]{a delegate contract could also modify the state}
\end{description}

\subsection{Evasion Targets}

Actually, this method is effective against all the detection agents:

\begin{description}
\item[everyone]{the data is not visible in the sources nor in the bytecode}
\end{description}

\subsection{Samples}

The contract can be entirely legitimate, and compromising the storage is enough.

It has been \href{\urlvideomasqueradingcode}{demonstrated by Yoav Weiss} with a \href{https://github.com/safe-global/safe-contracts}{Gnosis Safe}.
The constructor injected an additional owner into the storage, allowing a hidden address to perform administrative tasks.

\subsection{Detection \& Countermeasures}

\subsubsection{Gas consumption}

Storing data on the blockchain is a \href{\urldocsgascost}{very costly operation}.
If nothing else, changes to the storage can be detected through gas consumption, especially when writing to empty / unsued slots.
