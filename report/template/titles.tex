\makeatletter

%----------------------------------------------------------------------------------------
%   SECTION NUMBERING IN THE MARGIN
%----------------------------------------------------------------------------------------

\newcommand{\autodot}{.} % separate title numbers with dots
\newcommand*{\numberinmargin}[3]{\makebox[0pt][r]{\textcolor{#3}{\fontsize{#2}{#2}\selectfont\sffamily\bfseries#1\autodot}\hskip\marginparsep}}

%----------------------------------------------------------------------------------------
%   SPACING
%----------------------------------------------------------------------------------------

\titlespacing*{\chapter}{0pt}{-30pt}{20pt}

\titlespacing*{\part}
  {-1.5cm} % left
  {8cm} % before
  {20pt} % after

%----------------------------------------------------------------------------------------
%   TITLES
%----------------------------------------------------------------------------------------

\titleformat{\part}[display]
  {\fontsize{48}{60}\selectfont\sffamily}
  {}
  {0pt}
  {}

\titleformat{\chapter}[hang]
  {\normalfont\huge\sffamily\bfseries}
  {\numberinmargin{\thechapter}{30}{ocre}}
  {0pt}
  {}

\titleformat{\section}
  {\normalfont\large\sffamily\bfseries}
  {\numberinmargin{\thesection}{16}{ocre}}
  {0pt}
  {}

\titleformat{\subsection}
  {\normalfont\normalsize\sffamily\bfseries}
  {\numberinmargin{\thesubsection}{12}{black}}
  {0pt}
  {}

\titleformat{\subsubsection}
  {\normalfont\small\sffamily\bfseries}
  {\numberinmargin{\thesubsubsection}{10}{black}}
  {0pt}
  {}

\titleformat{\paragraph}
  {\normalfont\small\sffamily\bfseries}
  {\numberinmargin{\theparagraph}{10}{black}}
  {0pt}
  {}

%----------------------------------------------------------------------------------------
%   SHOW / HIDE PART TITLE
%----------------------------------------------------------------------------------------

\newif\ifbackgroundtitlevisible
\backgroundtitlevisibletrue

\newif\ifbackgroundbarvisible
\backgroundbarvisibletrue

\let\originalpart\part

\renewcommand{\part}[1]{% to reference in the background => display vertically
\setparttitle{\uppercase{#1}}
\backgroundtitlevisiblefalse
\originalpart{#1}
\backgroundtitlevisibletrue}

%-------------------------------------------

\makeatother
