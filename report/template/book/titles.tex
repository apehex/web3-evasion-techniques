\makeatletter

%----------------------------------------------------------------------------------------
%   SECTION NUMBERING IN THE MARGIN
%----------------------------------------------------------------------------------------

\newcommand{\autodot}{.} % separate title numbers with dots
\newcommand*{\numberinmargin}[3]{\makebox[0pt][r]{\textcolor{#3}{\fontsize{#2}{#2}\selectfont\sffamily\bfseries#1\autodot}\hskip\marginparsep}}

%----------------------------------------------------------------------------------------
%   LAYOUT
%----------------------------------------------------------------------------------------

\titlespacing*{\part}{-2.95cm}{8cm}{20pt}

\titlespacing*{\chapter}{0pt}{-30pt}{20pt}

\titlespacing*{\paragraph}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

%----------------------------------------------------------------------------------------
%   PART PAGE
%----------------------------------------------------------------------------------------

\titleformat{\part}[display]
  {}
  {}
  {0pt}
  {\begin{tikzpicture}[overlay]
    % horizontal black strip behind title
    \node[anchor=base, text centered, text depth=1, text width=\paperwidth, inner sep=0mm, outer sep=0pt, minimum height=48mm, minimum width=\paperwidth, fill=black] {\parbox{\paperwidth}{}};
    % introduction block below title
    \node[anchor=north west, text depth=1, inner sep=0pt, outer sep=0pt, minimum width=\paperwidth, xshift=0cm, yshift=0cm] at (current page.west) {\currentpartintro};
  \end{tikzpicture}
  \fontsize{48}{60}\selectfont\sffamily\color{white}\MakeUppercase}

%----------------------------------------------------------------------------------------
%   SHOW / HIDE PART TITLE IN THE LEFT BAR
%----------------------------------------------------------------------------------------

\newif\ifbackgroundtitlevisible
\backgroundtitlevisibletrue

\newif\ifbackgroundbarvisible
\backgroundbarvisibletrue

\let\originalpart\part

\renewcommand{\part}[1]{% to reference in the background => display vertically
\setparttitle{\uppercase{#1}}
\backgroundtitlevisiblefalse
\originalpart{#1}
\backgroundtitlevisibletrue}

%----------------------------------------------------------------------------------------
%   TITLES
%----------------------------------------------------------------------------------------

\titleformat{\chapter}[hang]
  {\normalfont\huge\sffamily\bfseries\color{orange}}
  {\numberinmargin{\thechapter}{24}{orange}}
  {0pt}
  {\MakeUppercase}

\titleformat{\section}
  {\normalfont\large\sffamily\bfseries\color{white}}
  {\numberinmargin{\thesection}{16}{orange}}
  {0pt}
  {\MakeUppercase}

\titleformat{\subsection}
  {\normalfont\normalsize\sffamily\bfseries\color{white}}
  {\numberinmargin{\thesubsection}{12}{white}}
  {0pt}
  {}

\titleformat{\subsubsection}
  {\normalfont\small\sffamily\bfseries\color{white}}
  {\numberinmargin{\thesubsubsection}{10}{white}}
  {0pt}
  {}

%----------------------------------------------------------------------------------------
%   SPECIAL TITLE
%----------------------------------------------------------------------------------------

\renewcommand{\paragraph}[1]{%
  \par\vspace{3.25ex plus 1ex minus .2ex}%
  \noindent\hspace*{-4cm}\colorbox{orange}{%
    \hspace*{4cm}\normalfont\huge\sffamily\color{white}\uppercase{#1}
  }%
  \par\nobreak\vspace{1.5ex plus .2ex}%
}

%-------------------------------------------

\makeatother
